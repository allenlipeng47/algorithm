package com.pli.project.algorithm.leetcode;

import java.util.*;

/**
 * Created by lipeng on 2016/6/7.
 * You have a number of envelopes with widths and heights given as a pair of integers (w, h). One envelope can fit into another if and only if both the width and height of one envelope is greater than the width and height of the other envelope.
 What is the maximum number of envelopes can you Russian doll? (put one inside other)
 Example:
 Given envelopes = [[5,4],[6,4],[6,7],[2,3]], the maximum number of envelopes you can Russian doll is 3 ([2,3] => [5,4] => [6,7]).
 */
public class RussianDollEnvelopes {

    // graph solution, but it exceeds time limit. Should use longest increasing subsequent solution.
    public static int maxEnvelopes2(int[][] envelopes) {
        int len = envelopes.length;
        int[] inDegree = new int[len];
        HashMap<Integer, HashSet<Integer>> inBound = new HashMap<>();  // HashMap as graph
        HashMap<Integer, HashSet<Integer>> outBound = new HashMap<>();  // HashMap as graph
        for (int i = 0; i < len; i++) {
            inBound.put(i, new HashSet<>());
            outBound.put(i, new HashSet<Integer>());
        }
        // construct the graph
        for (int i = 0; i < len - 1; i++) {
            for (int j = i + 1; j < len; j++) {
                // there is an arrow from i to j
                if (envelopes[i][0] < envelopes[j][0] && envelopes[i][1] < envelopes[j][1]) {
                    inBound.get(j).add(i);
                    outBound.get(i).add(j);
                }
                else if (envelopes[i][0] > envelopes[j][0] && envelopes[i][1] > envelopes[j][1]) {
                    inBound.get(i).add(j);
                    outBound.get(j).add(i);
                }
            }
        }
        int ans = 0;
        while (!outBound.isEmpty()) {
            List<Integer> delNode = new ArrayList<>();
            for (Map.Entry<Integer, HashSet<Integer>> entry : outBound.entrySet()) {
                if (entry.getValue().size() == 0) {
                    delNode.add(entry.getKey());
                }
            }
            for (int to : delNode) { // delete the edges going to i
                for (int from : inBound.get(to)) {
                    outBound.get(from).remove(to);
                }
                inBound.remove(to);
                outBound.remove(to);
            }
            ans++;
        }
        return ans;
    }

    public static void main(String[] args) {
        int[][] envelopes = {{3419,8423},{164,2627},{3139,7517},{1751,4154},{9489,86},{6637,3814},{8056,4472},{1361,7808},{8951,7291},{2729,3128},{3981,8815},{492,3230},{8077,8257},{1046,8951},{7601,3995},{8077,2335},{7913,6100},{2120,552},{8052,7377},{3699,4314},{4956,9383},{1398,9645},{5612,3194},{1041,7969},{9353,9504},{3498,6074},{3778,6387},{6444,926},{8188,3068},{7573,9346},{1947,2744},{3161,1583},{6931,2466},{3123,2746},{3063,9465},{5436,4950},{2706,2321},{705,4817},{6848,3079},{7513,2377},{3314,3572},{1932,2535},{2635,6677},{31,1250},{3553,3075},{8978,2303},{6216,5277},{6544,5712},{8566,6145},{3541,9898},{7554,842},{1566,7443},{3891,2823},{8698,8532},{1692,6859},{4094,8342},{5207,9744},{3020,3461},{4752,6631},{2033,1323},{6094,3315},{16,8209},{3776,2627},{8889,2818},{755,2167},{9267,8809},{9701,777},{9464,9921},{2657,9329},{8606,8059},{6912,9454},{133,6606},{7149,5042},{7765,6180},{5361,4592},{7149,1438},{847,9109},{732,786},{9824,548},{9833,2443},{9920,232},{9957,8386},{1792,5312},{2950,3834},{3650,7948},{900,5644},{9741,7375},{964,6898},{7896,1036},{2274,3628},{5552,3985},{7669,8468},{5923,2191},{8154,1137},{7929,9618},{7960,4999},{3502,9719},{516,2896},{4059,2421},{3576,1295},{4835,20},{5679,8186},{7977,1570},{6570,8718},{5669,7159},{1610,6839},{5384,9486},{9839,1342},{5313,3512},{7560,7329},{3341,4860},{7253,8250},{4720,2680},{935,6817},{5006,9489},{3847,7892},{8131,367},{2769,8649},{7110,6644},{1890,5743},{1839,7297},{3431,1254},{5021,4290},{2902,1220},{4068,7124},{7223,1315},{5996,7738},{847,9773},{4553,7993},{3469,952},{3515,7868},{7258,8196},{9604,9484},{6500,397},{6891,2653},{495,4697},{3922,6202},{9333,956},{3946,3785},{1766,4052},{9708,5744},{7309,1019},{5938,3607},{1017,5011},{5151,6079},{4784,6132},{4469,8449},{8021,8735},{7943,2157},{5530,880},{2771,3653},{9851,776},{9714,7691},{4316,929},{9939,5982},{6155,3487},{4452,528},{6640,1633},{8847,3833},{8645,9925},{1031,4648},{6649,3067},{8969,2393},{3186,8448},{565,5104},{5092,1023},{7873,4665},{2515,5720},{6144,2960},{700,8342},{4431,4285},{7759,9179},{640,8724},{7558,6663},{2450,451},{5821,4868},{3596,760},{5009,6504},{4648,7689},{2385,4910},{7638,7327},{6783,5319},{3676,6987},{8202,5463},{101,9837},{9912,462},{2772,189},{8645,5511},{58,9865},{8230,7244},{7999,1685},{4491,6946},{2053,9514},{3479,7752},{8697,4200},{302,5464},{7360,1570},{7161,2012},{4755,304},{3088,1774},{6916,2967},{5635,1766},{4033,3320},{6795,3705},{4940,4164},{5895,2120},{8274,5160},{1587,2423},{9239,646},{5364,3424},{9598,1878},{4279,5057},{6076,4919},{5442,8463},{6785,2420},{8948,6061},{4613,3600},{5615,9879},{553,566},{3969,6767},{4233,8141},{5915,9627},{7497,9335},{2988,1508},{9533,5078},{1460,5468},{2030,6293},{5930,9963},{193,3541},{1911,2059},{295,6403},{9339,3504},{372,262},{4527,3135},{8408,1766},{2130,9366},{7508,1038},{3183,6667},{8439,4494},{3545,9626},{4932,1949},{7300,5433},{9733,3062},{9043,8371},{4449,1292},{3780,3665},{4830,6385},{1914,2260},{9547,8398},{8192,4081},{9069,38},{7308,4335},{4486,3126},{3224,6383},{6189,1328},{3401,935},{9071,2072},{4591,5583},{4437,8822},{4282,5162},{8733,3858},{2840,1896},{3480,3917},{6857,18},{2789,2228},{2912,7451},{2652,5706},{995,1861},{8674,6892},{9996,9738},{5449,8871},{8312,1103},{5457,4655},{2453,6727},{6094,433},{6805,443},{2448,525},{8633,7809},{628,2267},{720,2152},{4002,2141},{4648,7356},{7727,7373},{2672,7377},{2167,8724},{7647,2675},{5651,2636},{7644,744},{6601,4675},{3520,9348},{6569,3205},{9032,1994},{551,5461},{123,1252},{6170,4152},{1065,8283},{6624,5409},{7434,8864},{1182,6224},{3507,5842},{236,5240},{8487,6696},{2569,5827},{3541,7796},{2448,5561},{8487,646},{3523,9671},{1627,7796},{8190,7153},{5359,7583},{205,7545},{6987,4837},{5565,2428},{6259,9303},{9802,2069},{6574,167},{1302,1832},{278,3384},{568,7350},{8494,5624},{42,4217},{8344,3529},{3992,5501},{9033,4418},{9092,3589},{8016,1091},{9518,6786},{6403,7721},{8460,1063},{4757,6917},{4226,3967},{735,1858},{635,381},{7161,3228},{5017,3918},{4288,1162},{1260,981},{5776,8491},{9548,2987},{6748,2291},{5319,3510},{2631,9475},{4384,5186},{3357,5721},{7295,7478},{8801,943},{1418,3917},{689,6308},{1366,3676},{3710,7366},{6108,475},{5856,8197},{8403,2726},{5214,6996},{5813,7581},{2058,1726},{9845,687},{4647,2464},{6379,4875},{9739,557},{4093,9986},{3154,6687},{4032,1770},{4686,5511},{6607,1506},{5590,226},{8861,7951},{1146,1162},{7158,1662},{9817,1726},{6390,9393},{1549,1160},{5843,7524},{7125,24},{5006,1893},{3563,3810},{2964,7382},{2880,7801},{9028,8592},{8650,7525},{1611,7947},{8537,789},{6586,4676},{9236,7970},{5273,5041},{6595,3801},{2224,4833},{6583,8983},{4913,5398},{1634,1467},{5328,8075},{806,9955},{3891,568},{4013,9055},{7210,4487},{2670,2048},{4324,762},{250,5714},{4946,4326},{6442,4346},{8879,90},{4282,8913},{7466,8562},{9660,1411},{6163,529},{2526,5216},{7677,1516},{175,6919},{4090,7858},{86,2127},{2833,4769},{6810,2645},{2372,4302},{9570,8819},{480,4842},{2922,8848},{993,346},{9707,112},{4177,9837},{3737,1106},{186,6071},{3165,2657},{7210,7813},{3805,5090},{3419,7418},{3541,458},{1543,9177},{1962,4223},{4629,1203},{661,6285},{1045,2160},{7165,7319},{8204,7633},{5348,8277},{7104,6192},{601,9090},{6513,1631},{4470,8037},{2593,9678},{7453,3935},{4576,3346},{3466,8858},{5237,8578},{5297,2007},{224,5824},{8356,590},{5449,8894},{6101,8913},{4868,6576},{4936,8602},{2340,5225},{3318,6480},{4979,9850},{5617,3163},{2231,8435},{5588,8847},{4920,5553},{1904,4902},{1935,9232},{9758,8164},{9465,7513},{1832,6327},{2545,2200},{882,5761},{5022,6228},{9563,2729},{5167,3803},{1043,4592},{4273,8811},{5321,1945},{1748,4884},{3167,7344},{4639,3860},{9074,5041},{3430,927},{56,7432},{1097,7868},{9620,5368},{1701,8479},{8679,4476},{9107,5355},{9536,4623},{6025,2051},{4529,7989},{4938,4988},{3051,1921},{6383,3113},{7395,2231},{1255,6176},{5291,4542},{7559,8595},{5507,7907},{1233,2925},{7263,1486},{111,5138},{3603,3804},{5895,9495},{7529,4516},{1320,6530},{8603,7522},{6696,752},{2391,4186},{2327,8402},{2100,3740},{6879,8048},{3308,878},{5360,8555},{6567,533},{8616,2899},{8231,2101},{5798,7479},{3678,1951},{9135,6402},{4505,7405},{2750,6308},{8859,1251},{6464,7134},{7469,2872},{6976,3802},{4782,127},{1245,2204},{4887,2139},{5463,6743},{6562,2404},{5583,1156},{1898,210},{3645,4787},{1795,6117},{7687,4026},{7719,5872},{479,4894},{3346,5680},{5919,2844},{977,9758},{7825,925},{3487,2815},{9622,1356},{754,6871},{8064,6207},{2467,890},{1448,5171},{1131,7398},{6106,2893},{1548,9523},{7105,8438},{7676,6314},{736,3308},{8368,406},{9255,2283},{7547,8880},{8710,6490},{9808,5240},{1543,2858},{6779,4249},{9697,6562},{8994,8728},{5780,5773},{3157,632},{8514,4102},{1712,3850},{475,2232},{2710,3875},{9034,9874},{3788,4556},{5251,9852},{3274,4668},{6126,9485},{7487,4006},{9819,1816},{963,3521},{9561,6151},{400,1314},{3130,957},{3994,4210},{2206,6786},{5544,6610},{415,1050},{1033,4284},{5019,1453},{1127,1034},{5703,4260},{2448,8930},{6106,2169},{627,2576},{371,8500},{4456,7397},{4927,2071},{5933,1126},{2040,5758},{5877,843},{9072,9226},{857,7253},{3934,4303},{1437,629},{2704,9620},{2455,3945},{6229,1497},{2010,4477},{7712,7740},{7841,5412},{2549,2643},{7748,4556},{2511,934},{5028,5986},{8357,4405},{6678,2823},{6544,5566},{4645,955},{1678,6289},{3143,5870},{5662,5190},{4563,9213},{1165,4975},{3524,897},{1832,4788},{9958,7179},{9274,8808},{1859,8891},{4280,5213},{2649,3367},{9262,9044},{6177,4538},{7346,9920},{7636,3361},{1105,7269},{3754,1958},{1396,6596},{3612,8457},{3811,5423},{5569,1726},{1368,4798},{8315,1784},{9788,82},{2975,8828},{736,3910},{6310,2350},{8019,4957},{8821,8424},{6303,9999},{8934,503},{765,1558},{2188,6312},{8350,6508},{9129,7563},{5185,7359},{1576,2401},{3573,5644},{2096,6396},{5389,3103},{8682,876},{42,7509},{5182,8370},{2002,5682},{3436,8522},{8337,5170},{3028,3488},{4990,4629},{4838,9476},{2555,5468},{5983,2590},{7076,5804},{6465,2813},{1727,4127},{7102,4764},{9565,7331},{4868,8886},{1716,9872},{8785,4990},{9299,233},{4905,1993},{6051,4834},{8365,3078},{7986,4398},{7087,5074},{6305,9786},{151,8679},{4519,8033},{9350,6508},{4655,5539},{113,3107},{7554,1340},{5571,2200},{2764,2629},{7587,1802},{9931,1938},{896,689},{914,874},{4071,4212},{4491,7311},{6746,5988},{9368,9848},{1681,571},{4816,503},{4513,7553},{5008,5734},{4895,1901},{9289,8473},{1238,1380},{1258,7138},{9350,610},{9119,7964},{8820,6119},{9158,4363},{8265,2996},{6223,1484},{5430,2891},{7879,7624},{3874,6205},{5671,7942},{7723,3069},{3374,8616},{8931,795},{631,5315},{1030,7284},{2784,4813},{3536,5035},{4866,9482},{3470,6296},{9152,4592},{8447,9723},{3070,3316},{462,632},{1955,610},{5225,5570},{8642,6122},{8580,3031},{978,5393},{468,7000},{6406,5715},{1349,8723},{5215,245},{9519,6500},{3092,1941},{9550,2119},{6721,2155},{8081,6175},{8206,8560},{7256,1820},{8599,2968},{4793,503},{8592,2361},{3884,2784},{4694,4820},{6072,7011},{9683,7626},{3792,864},{3778,559},{6220,1653},{4116,2771},{8830,1838},{7362,2574},{5750,3120},{4005,8227},{2016,7286},{9442,785},{4610,5359},{3743,2121},{8985,9083},{5797,6126},{1841,5097},{9028,6468},{6336,4879},{6293,513},{8177,1901},{599,5955},{3433,8510},{3688,1730},{2126,1076},{7990,1886},{3650,4333},{1466,1396},{9265,5691},{2663,5918},{6203,12},{4896,9788},{4810,3282},{4052,8679},{4920,1650},{8919,7203},{5154,2703},{3536,2062},{85,2191},{6146,4292},{7600,3587},{8889,1779},{1096,1452},{4530,8404},{7693,8257},{311,8720},{5203,7572},{8438,9896},{2967,9642},{6532,1279},{1782,3184},{5358,1807},{4744,754},{2582,6449},{9616,819},{9060,5528},{7158,1332},{6212,1079},{9156,8915},{9868,1751},{8532,3795},{8562,8830},{1730,8202},{6850,5161},{8413,5858},{2630,2075},{9485,1597},{2091,2026},{7365,7361},{7931,9445},{5776,161},{3054,5377},{8635,9519},{6221,9097},{5922,2987},{5134,3667},{4465,9930},{4110,7927},{5105,9739},{5490,8721},{3218,1732},{2271,4619},{996,8976},{9629,7824},{5169,4492},{708,754},{527,4128},{4940,2891},{5688,7901},{3218,6274},{50,9100},{9407,9852},{3388,4223},{2854,437},{8139,3080},{1174,2803},{6664,8086},{2649,3385},{563,2269},{1260,8510},{8336,3491},{8612,1524},{2990,5620},{7834,7495},{1962,6342},{1512,911},{4388,3806},{2728,2606},{8750,4764},{3739,5428},{1957,7263},{1826,8511},{3014,6103},{495,3316},{8843,9201},{5524,3364},{5291,2062},{8223,7153},{3201,3021},{6201,3755},{8693,3040},{7216,7623},{5312,8788},{4697,8126},{2660,3388},{4414,50},{3137,4689},{1003,6118},{4202,144},{9427,2398},{4099,2302},{606,1910},{3104,4603},{5570,5063},{9421,3258},{1957,7713},{9520,4110},{5965,2154},{4502,5971},{5449,9115},{9620,2235},{2864,7949},{1393,8319},{6154,533},{6642,5501},{8705,9342},{3149,8354},{7011,316},{1990,6995},{5472,868},{1613,4846},{2976,6171},{7614,4620},{8971,2416},{1971,4504},{1240,5701},{3752,1240},{9680,9662},{8100,8123},{6913,8324},{3345,900},{1017,3611},{4486,2186},{4663,4554},{9831,57},{3316,6669},{73,5333},{1115,8019},{944,8086},{3950,1266},{3229,2844},{3132,2336},{8608,9418},{4201,1368},{8535,2596},{1653,5569},{6593,3663},{9103,7928},{5857,9928},{4337,9344},{7998,5371},{4867,4648},{3218,2732},{3664,8269},{4756,7986},{7196,7299},{2159,1118},{499,7005},{1783,2304},{5702,4673},{3207,324},{6095,747},{2207,5936},{7449,7727},{160,6228},{5655,9715},{4606,6884},{1856,2596},{1766,9354},{8702,4916},{9556,2157},{5730,2267},{9640,6748},{6849,4511},{4052,9210},{437,8950},{1570,8322},{9993,8728},{9663,7064},{2660,3644},{5603,6212},{5057,321},{8882,9132},{7582,8095},{8638,1191},{7064,3041},{8490,3064},{3557,3727},{8763,4009},{8528,2819},{1253,6751},{922,9788},{7259,5007},{1417,7453},{6630,5659},{2898,4527},{1890,8672},{5801,3839},{7952,1915},{2477,6751},{6034,9657},{9455,5645},{4245,3746},{1726,7269},{7682,7999},{2050,2082},{8854,5353},{6669,7047},{7298,4448},{9117,5025},{5262,9172},{7323,3097},{4759,144},{5749,8955},{658,8138},{6470,3629},{8661,3058},{8737,2902},{3146,3197},{5889,8393},{88,2278},{7234,7601},{8353,9491},{4102,5084},{7255,4462},{7293,9747},{5817,2245},{4847,3321},{6984,9509},{4548,807},{8482,8370},{5059,7970},{8139,7002},{4598,5336},{357,7991},{9350,6280},{6449,8037},{3649,6078},{8476,9341},{644,6263},{435,6002},{8695,546},{5457,1841},{6567,5305},{7096,2325},{8909,5613},{2824,4364},{8018,8368},{2349,8632},{2938,3850},{8797,6545},{8413,5426},{734,3562},{3183,5570},{936,3117},{1886,2016},{1936,7445},{6889,6315},{8863,2751},{9435,9549},{3093,1539},{1244,2828},{8856,5644},{1142,1035},{9586,946},{5884,2948},{5588,6575},{1732,9703},{3970,3594},{8272,5776},{1750,9617},{9438,3397},{8127,5507},{5077,4997},{2491,8506},{6871,9367},{5216,6863},{1386,4247},{8235,8286},{8667,509},{8250,1311},{5295,428},{6134,2609},{7333,4899},{5440,8660},{9821,6717},{479,7513},{4729,2102},{8670,628},{4993,6835},{5848,1409},{6124,3871},{1329,423},{983,1670},{8521,1470},{3078,1961},{8239,7611},{6797,9295},{2988,2293},{2867,6217},{1698,5727},{9230,5872},{6281,4207},{1270,4549},{3114,3718},{3532,4083},{9590,516},{410,275},{3523,4840},{7394,79},{6797,6009},{9479,2681},{7835,4631},{1455,6450},{6267,2795},{4197,624},{3645,9743},{874,212},{3467,6872},{6941,1000},{7153,3765},{2828,4716},{6552,5041},{8930,4786},{511,7158},{6957,6325},{2810,8189},{1418,8148},{8092,4096},{2192,989},{6565,5386},{1951,2248},{868,1324},{7099,5575},{1359,7041},{1989,9968},{5908,8190},{3445,4018},{4364,1467},{8236,5839},{5770,3295},{4652,370},{2742,2775},{7314,7893},{8065,2177},{954,7802},{8986,5081},{8984,844},{6734,5052},{3585,3040},{6260,7975},{6174,9638},{77,6897},{4500,9537},{3990,6441},{6788,5574},{1365,3657},{7037,992},{4385,704},{7721,6724},{993,9855},{7644,7587},{5367,4404},{3896,1492},{7937,2227},{8580,5630},{8011,1909},{965,6858},{9058,5003},{6847,7154},{5217,9201},{4870,6270},{1075,927},{6272,2014},{7858,1166},{4796,5784},{5488,5665},{1709,9951},{3908,5038},{4523,7819},{58,9899},{9589,4679},{8301,1684},{7928,4667},{8152,9071},{2615,7914},{7627,6},{4724,6035},{5177,6242},{4777,4117},{9731,2085},{5187,7167},{6474,3942},{6652,6705},{4160,3199},{8670,1712},{8772,4159},{7344,6416},{2182,4602},{7801,5227},{4878,9338},{86,7444},{4897,5287},{3912,6381},{6930,642},{9757,9458},{8941,3714},{186,4810},{6132,4283},{964,6943},{3353,9774},{5484,8387},{1666,8825},{2944,9577},{8100,1604},{1008,4658},{3883,8723},{6561,2266},{6855,9689},{1882,9239},{3292,9128},{7509,5721},{2388,4136},{9729,9658},{2221,114},{2869,8215},{4272,1047},{8140,2660},{7873,3693},{7362,4894},{9548,6021},{4009,8848},{6553,9544},{1739,9837},{4109,6171},{4500,1181},{5698,544},{6627,6380},{5716,4310},{184,5046},{1384,2714},{3763,7044},{7725,3980},{783,5892},{8227,4512},{2431,8474},{1496,3074},{8762,8306},{8234,2235},{9843,5460},{3922,101},{8965,5783},{9948,4888},{7589,8904},{1905,7850},{4399,6872},{9340,5840},{3307,3611},{2001,3321},{5485,5869},{9010,8950},{2440,4717},{750,9635},{7665,5321},{6046,2979},{4381,255},{8629,5206},{3875,7486},{487,984},{5248,4281},{548,7100},{1886,605},{3927,4760},{8110,956},{4495,2343},{7497,2577},{3098,3900},{7790,1253},{4923,1555},{5220,8339},{2003,8552},{8165,1710},{5191,7253},{6385,3910},{6722,6594},{6336,7663},{7179,1887},{2923,6548},{2407,7119},{4849,7249},{8618,1649},{8845,5231},{4637,9902},{6419,6285},{7313,2792},{9053,429},{2860,6541},{6158,8463},{9114,5686},{3050,2894},{1163,9608},{6707,8842},{2632,2307},{7861,599},{1907,869},{3391,947},{7183,8048},{8268,8376},{4014,4532},{6804,7961},{5582,2377},{2720,1062},{3340,7499},{713,1369},{5627,4950},{461,1636},{806,1861},{8180,9},{9349,7195},{273,3157},{7319,3247},{2014,5168},{7096,3065},{3866,6901},{6698,7829},{8345,2218},{5552,7185},{8519,3119},{6037,948},{820,6919},{7376,1868},{6182,8460},{1742,944},{6424,7944},{4323,5709},{5358,6487},{6891,3595},{238,6010},{1924,6163},{9933,3489},{8573,1938},{5944,6394},{9480,6137},{5432,2007},{4789,7925},{9735,2662},{7423,3649},{9748,6113},{5472,4259},{7004,6711},{2343,7036},{8621,8019},{7568,1494},{9474,8361},{1776,706},{5708,8157},{1460,1518},{3074,5455},{3390,8699},{2337,3517},{962,7208},{1203,7242},{3188,2175},{2971,571},{3106,5753},{9096,3709},{4653,2867},{4376,8570},{1788,1296},{5311,568},{2357,5387},{581,7476},{9800,1148},{6172,4565},{1644,6558},{612,8824},{7540,2132},{4673,2098},{8481,6814},{7157,8336},{4935,4},{820,809},{4934,1039},{8287,6391},{4876,2649},{7854,6134},{7914,3740},{9102,9712},{3014,6240},{9241,3974},{8677,6088},{2660,761},{9176,8888},{480,7207},{9265,4448},{9833,2115},{5334,6103},{5636,6324},{5979,774},{7538,5317},{1423,8153},{5703,4615},{6745,3643},{721,723},{5532,7907},{8764,426},{2514,489},{718,5905},{5293,7935},{6323,6442},{8766,3019},{9269,401},{1240,7461},{1762,8907},{9192,6416},{7178,6528},{7533,3346},{5228,5820},{1187,6611},{4382,5429},{895,5668},{5649,2400},{3258,1921},{2248,8609},{2553,9748},{6615,1028},{7445,9631},{3415,29},{8364,9953},{695,3827},{4719,3557},{253,417},{2680,6661},{4749,8520},{2871,3941},{932,924},{4408,1048},{8303,8204},{2209,5750},{8802,5129},{2318,5164},{3031,4760},{7834,5845},{5217,9639},{8122,5600},{3626,2645},{1756,3037},{1847,1583},{3785,1179},{9458,2334},{2571,6245},{8016,1434},{3009,2037},{6370,8007},{7807,8962},{4416,6474},{4268,2424},{9977,6277},{3943,7063},{9813,6950},{2611,7058},{7908,3353},{485,4793},{4965,6096},{4489,7542},{2318,4312},{6074,3570},{1015,7782},{2846,4959},{4171,3860},{6138,8275},{8070,9459},{2329,6328},{1323,5187},{5379,245},{3986,993},{1259,3343},{1206,2771},{3852,7952},{8561,9459},{5901,7286},{7678,8798},{4502,3467},{3824,5822},{3604,3619},{7910,923},{5067,7610},{2979,841},{6953,1708},{1376,1889},{7723,3891},{264,5994},{7145,6609},{9946,7415},{4881,3528},{5478,4257},{9486,415},{6798,1166},{6345,3404},{3570,8907},{3820,4725},{8434,2880},{8426,3499},{8945,3282},{8168,6088},{5442,6509},{2744,7767},{940,7314},{3194,1720},{156,885},{6027,1979},{8685,780},{3431,4352},{442,5307},{5896,2605},{3154,6844},{9150,7860},{3516,9341},{3354,175},{9314,6769},{6344,69},{4996,18},{1575,5406},{9944,5262},{1026,2621},{1010,8651},{1560,6436},{6888,3562},{9185,6154},{594,4159},{5750,3199},{1988,3230},{8300,3705},{6034,8806},{5885,4566},{7505,9655},{1389,8477},{1986,1881},{411,9310},{3900,6732},{5913,2188},{865,129},{4893,2932},{2598,1042},{4717,989},{1388,3691},{6223,1341},{5433,7023},{7367,1176},{8993,3738},{2571,535},{3883,240},{9535,6407},{7831,9828},{9435,6771},{1393,1612},{9365,6093},{4336,1957},{2825,3904},{8522,5197},{6936,4498},{9977,1546},{4772,1222},{6297,1890},{9590,8405},{4754,7440},{9550,5649},{1558,8613},{351,9547},{2519,2652},{6474,2689},{3382,5148},{3099,2040},{9781,2312},{4469,361},{568,7787},{9071,9092},{104,1550},{1797,7214},{4144,3543},{7867,2235},{8780,8810},{954,5167},{5908,1718},{4134,7536},{7864,5477},{2137,1719},{3951,4920},{7916,6112},{9635,6776},{5875,4369},{8452,7973},{4567,864},{6726,5474},{3279,1833},{3825,8332},{8574,6158},{1216,7391},{2520,5321},{7328,1206},{3612,511},{3113,8755},{7571,615},{1783,8130},{8445,4518},{683,2859},{1859,365},{6136,2241},{6810,1868},{1530,6211},{3636,4293},{6501,109},{2492,2220},{6878,1006},{640,8799},{6909,3441},{2251,6790},{5346,4873},{6470,1049},{8922,9190},{5771,2871},{2438,5661},{64,2478},{4833,2911},{7395,5016},{7604,3905},{3263,1115},{980,2547},{1662,9366},{5079,9227},{1028,1783},{3236,2363},{1216,9027},{6169,3594},{1312,5822},{745,6836},{116,4497},{3410,6635},{7494,9838},{4701,4764},{4015,5352},{989,5645},{6186,7031},{8388,1399},{6600,5226},{5945,5910},{4090,4692},{1442,7063},{5148,4295},{8979,1996},{8101,6481},{1210,4269},{6696,4388},{8904,6014},{1002,4814},{4752,5560},{7094,7636},{2491,3364},{332,1754},{6367,313},{6338,4598},{8584,4056},{2852,5102},{6211,3359},{3874,6671},{8911,6000},{8656,5560},{591,1903},{1690,337},{1203,3896},{7637,3296},{7600,270},{9059,4451},{4805,5121},{3939,13},{141,4133},{460,3985},{3241,9863},{8469,4971},{1550,3343},{1548,4432},{2979,2074},{5945,7329},{9612,7885},{6784,5141},{7093,3693},{1733,3189},{626,2226},{574,6992},{773,1960},{7884,9282},{5655,3036},{3939,9066},{5861,2367},{6815,109},{2834,889},{6815,3166},{1999,9546},{444,460},{5947,6174},{575,9932},{2607,864},{2575,4271},{206,9845},{6512,573},{8013,3792},{8031,8424},{4310,4411},{3831,3786},{4041,6611},{5572,9735},{2776,1352},{6044,3400},{4885,2182},{8661,1968},{5074,7281},{4907,9828},{4494,7725},{8441,6313},{7978,9218},{4852,2024},{9661,6045},{996,7393},{89,61},{6286,9097},{6227,6620},{2019,1340},{7306,5391},{6048,7990},{1895,7613},{845,151},{7894,4455},{7278,1826},{4669,1028},{9,3041},{9614,5710},{5183,1303},{2291,2952},{2423,6835},{8711,6634},{5817,8761},{2746,8581},{9675,5574},{4163,9535},{9365,2270},{9143,572},{1185,4177},{9737,4136},{6993,6093},{97,7914},{532,8782},{8656,6114},{4405,6393},{3518,3258},{844,4940},{1537,306},{2244,1944},{4449,3566},{7104,767},{7719,8444},{2779,3620},{1910,9673},{5674,5598},{1104,3183},{2080,1750},{6528,9903},{7529,3985},{2204,8744},{8954,5546},{917,2923},{6964,7377},{9710,8161},{6082,5084},{6623,7924},{2722,289},{431,1880},{9747,9915},{1157,7191},{1561,361},{4754,94},{2286,682},{5408,7497},{8825,6838},{9644,1784},{8306,1610},{4213,1781},{752,5535},{3044,5128},{2602,3439},{2305,1257},{739,7267},{1964,391},{5177,447},{894,4375},{9490,283},{416,418},{4394,9795},{2456,1037},{1542,2829},{3555,4992},{8840,6203},{8107,7717},{2772,9513},{3155,7606},{3184,8477},{6390,2821},{6747,1859},{4839,3078},{1009,8862},{6233,8377},{8174,2639},{8566,4185},{7769,1455},{1758,9440},{7916,8724},{7950,6220},{3287,7289},{759,3528},{9952,2395},{5410,5822},{8575,1060},{6697,1293},{2965,8649},{7902,5906},{24,3912},{7842,6945},{6116,8793},{7559,6347},{3610,1432},{5818,2156},{8942,3722},{6188,6101},{8924,9833},{507,6272},{8487,5955},{6090,723},{4255,8923},{7033,8064},{8833,8001},{7352,332},{9503,9631},{977,5589},{704,4686},{4406,9486},{3639,7977},{6138,6731},{1691,8337},{3944,4615},{7106,2094},{1197,971},{605,9368},{5577,762},{5480,8353},{8248,9491},{1413,1525},{9001,2174},{7963,7397},{2171,3652},{2035,7357},{4228,6626},{377,1620},{1270,7129},{867,4531},{5502,5687},{8508,4102},{7540,7107},{6932,4140},{381,6078},{7304,7736},{1647,2927},{3906,6610},{528,308},{1592,8465},{336,239},{2552,8192},{6729,8372},{7373,7527},{9664,6688},{2877,4385},{7597,9038},{7055,1070},{7439,2004},{8070,7863},{6570,798},{932,7354},{303,6037},{6451,8521},{3815,1584},{3837,9042},{3799,942},{5659,4757},{8311,3062},{442,7582},{4127,8895},{3372,551},{1626,9952},{4303,3230},{7272,8637},{4536,1085},{6376,1232},{4979,7362},{2487,5239},{6704,8605},{7449,4181},{9035,1784},{4149,662},{4967,1958},{5075,6231},{6946,5102},{4147,8752},{1145,8535},{5628,3620},{5417,5798},{7850,4509},{4114,2691},{3754,6730},{4863,8},{3767,9361},{3309,8407},{6453,4585},{9171,6496},{5112,3642},{2293,3388},{3364,9225},{3777,4877},{7921,7986},{7992,2826},{8884,5646},{4362,6070},{5416,5785},{1128,5062},{7702,1091},{5593,6247},{7653,3257},{1740,9579},{9127,6378},{9437,9569},{5241,4308},{758,301},{986,4971},{8558,8125},{4711,1232},{5964,4940},{2162,2196},{9223,9604},{3043,2986},{8165,6191},{4880,9245},{8581,1288},{3827,934},{4723,6362},{8132,5633},{3661,2731},{8967,2126},{803,4100},{7853,5755},{3503,7284},{2395,6250},{48,433},{6561,5993},{2423,6496},{2340,5850},{3810,2340},{5568,3516},{4467,6648},{8508,663},{7608,3634},{2223,8593},{8050,2050},{2522,9410},{847,4139},{5908,4650},{2375,7382},{9319,3591},{9819,8085},{1665,4495},{7408,1052},{1124,7976},{5955,9533},{9601,5541},{6009,621},{6764,5148},{6,8871},{8183,4134},{3289,6097},{7148,9512},{1443,6510},{5005,3072},{280,3343},{7879,6608},{3070,4702},{6501,7046},{9747,8303},{7857,2631},{6150,750},{1713,6434},{8517,5958},{4954,6200},{6011,616},{1219,7174},{1805,8232},{8185,9671},{4499,7223},{9276,2285},{7140,2260},{7401,3577},{1642,5588},{1889,9489},{8220,3128},{7,1917},{7475,2710},{1863,367},{4420,8746},{592,2781},{1017,5973},{675,963},{5051,5226},{7722,4717},{616,3987},{2084,7512},{8145,1032},{2726,2975},{4092,2085},{9528,7959},{9661,9546},{2116,2544},{9154,3016},{2518,5681},{6848,4349},{6572,4521},{4861,5287},{7474,3174},{3401,2279},{2637,2073},{9258,348},{1886,705},{2155,3906},{1515,7682},{1450,596},{1896,5541},{4582,7315},{5909,5987},{47,3232},{2633,7300},{109,701},{9621,7320},{6308,7031},{4639,3982},{1984,572},{2387,6383},{2295,9533},{9033,9359},{5846,8739},{6564,8944},{8193,3615},{900,5767},{4879,1334},{3665,6330},{5782,6306},{6611,5730},{9296,8242},{8230,1872},{7510,4501},{537,2499},{5566,3790},{2839,2653},{8865,3188},{7385,8418},{9466,1290},{8527,7944},{2809,7724},{4524,3843},{7153,5885},{1733,9651},{2086,2587},{2938,703},{5876,4402},{8518,6613},{4834,5670},{6253,8105},{6109,814},{2534,1666},{7337,7098},{5595,8563},{4817,2708},{1844,9829},{4731,1940},{9395,8831},{9781,6285},{9649,7938},{887,9789},{7111,5908},{955,1442},{2888,8087},{8347,8066},{2487,2106},{4636,2091},{6298,135},{1767,5809},{1063,4335},{3249,5209},{3156,6404},{5089,7892},{1768,3957},{5271,5515},{4220,4272},{1311,3838},{6246,2171},{9919,2853},{249,1988},{9407,9084},{1686,1752},{5547,4301},{8037,4420},{8847,6239},{185,5718},{5544,6853},{45,7965},{9433,4446},{8098,2204},{6682,949},{3376,8591},{2621,6524},{9536,8752},{3371,1712},{4556,8164},{8909,3068},{9314,1662},{4940,3245},{3247,6771},{6823,8592},{6109,235},{3241,7440},{7887,4832},{6094,3849},{7104,3559},{3002,4145},{7249,220},{7737,4058},{9994,5786},{7528,3272},{1522,1865},{4916,480},{76,6315},{759,7096},{3653,856},{3124,9588},{2051,5876},{9338,4239},{9925,2695},{1259,4956},{783,5957},{9849,3036},{3357,9483},{3253,2449},{1495,5776},{3528,7929},{3730,9068},{9835,9226},{1093,4744},{4715,3247},{6494,7904},{2249,6382},{8466,1910},{9532,2657},{3212,6877},{2301,3262},{4706,3110},{1660,3364},{8529,1566},{663,5185},{1789,9798},{2788,6909},{7499,108},{3806,8478},{7320,6165},{2682,991},{7763,5088},{1347,9912},{7961,71},{3042,1656},{363,2765},{9703,9667},{5351,264},{3101,8845},{8255,5364},{5564,6612},{799,855},{5750,8620},{3081,245},{6410,2135},{5351,4459},{920,6674},{7168,1972},{8115,9988},{9893,5280},{1679,661},{3086,8679},{9651,9366},{7687,6966},{9457,7567},{4734,6850},{8959,7008},{8408,1716},{4179,6183},{1238,3204},{4290,4769},{9444,5997},{3781,5205},{4044,4496},{5188,4679},{8571,5877},{5967,5083},{8296,9313},{2291,4637},{1499,6568},{7183,9910},{1975,3386},{5193,7547},{9019,6939},{8866,4346},{5244,1610},{1313,8261},{6825,7251},{6257,6617},{6095,2033},{5817,2951},{9681,3065},{1680,3679},{9963,6986},{6360,3905},{9929,7131},{3888,3509},{1061,7350},{4356,8524},{655,6553},{7404,6156},{8499,1713},{3006,2439},{4483,7426},{5500,6387},{5737,793},{7250,3512},{7268,4869},{7905,9538},{5927,1295},{8344,1412},{5984,4955},{3831,2183},{5829,8209},{2229,2139},{4935,1168},{915,1203},{2755,5883},{6015,4566},{2143,9470},{6436,8624},{1275,5999},{7642,571},{2588,5250},{275,8389},{5955,501},{4144,5777},{1406,5747},{9578,9909},{10,8488},{6892,3660},{3273,5006},{5896,5949},{9582,3905},{5566,9243},{9946,8592},{5101,5329},{709,9980},{8799,2534},{2673,999},{4490,2610},{5438,7298},{3560,2708},{7277,6598},{5766,22},{2724,4030},{7840,9374},{2390,3470},{976,5934},{540,1718},{4175,7148},{4737,4101},{2902,1888},{5637,4926},{6468,8705},{8777,7946},{858,2552},{6965,2607},{6266,1371},{7156,2482},{5958,2089},{2662,5626},{2151,3188},{2532,8214},{8358,8948},{935,9681},{9955,1091},{5711,2485},{6475,1668},{7836,9799},{2322,1153},{3084,1057},{7516,9924},{6707,4907},{1811,6800},{5811,1340},{1947,6760},{9576,7894},{1766,207},{6973,1123},{4409,6822},{7226,8240},{7311,397},{534,674},{8814,2968},{8065,2842},{453,7290},{9948,1484},{632,6716},{9204,7270},{4500,1280},{4109,1852},{5117,6017},{9779,8273},{4811,7482},{1869,4914},{6287,1752},{610,6935},{5166,5922},{4435,3022},{7392,8772},{7585,2413},{9318,8769},{9953,9515},{4409,551},{7806,6657},{25,215},{1387,658},{8612,9877},{9196,2312},{2317,9935},{7546,1113},{4280,1816},{2236,4159},{4021,6370},{4233,9311},{8509,2542},{3288,6996},{5090,8589},{2635,3165},{843,3218},{2566,6872},{7932,9350},{2317,5423},{2037,2076},{883,342},{4189,8814},{6894,1431},{9673,2828},{9479,5249},{6474,3480},{8881,9505},{6003,6076},{5383,143},{8669,2632},{3917,9766},{3715,9529},{9206,6088},{892,1529},{3757,5027},{447,5940},{4073,5860},{5593,6235},{1110,8160},{7287,3534},{8103,915},{4417,9962},{332,4255},{7708,3518},{7223,7783},{6420,8504},{6531,9502},{8509,9135},{6149,487},{1172,7548},{9262,7085},{7986,4734},{1084,8941},{9972,9023},{4340,9226},{6645,6412},{9738,1680},{3369,4270},{5684,9612},{591,2008},{7859,1686},{9998,3620},{1629,5253},{1121,9756},{3503,6699},{6861,3325},{4488,9583},{5454,6053},{3000,8214},{364,8195},{7698,5120},{2819,924},{1357,9166},{6724,853},{838,8296},{5566,7929},{2990,1455},{93,30},{2188,8634},{2762,6378},{1925,3754},{775,5943},{752,7283},{1671,4150},{3550,5946},{4444,933},{6658,8046},{3092,6886},{615,6004},{6767,5117},{8292,5584},{726,278},{836,4702},{6323,8421},{4944,9058},{9148,8140},{7728,7161},{597,1875},{3712,3298},{6785,8540},{3155,7715},{4137,6559},{2632,2026},{3022,7766},{4159,4443},{1720,2335},{535,8284},{8598,324},{6838,472},{9391,2776},{9293,5092},{771,2012},{556,1789},{1290,2253},{828,1601},{8604,8443},{4578,2827},{5872,6684},{8598,3039},{3266,6815},{984,8725},{5538,1250},{2590,297},{5776,3926},{3301,8535}};
        System.out.println(maxEnvelopes2(envelopes));
    }

}
